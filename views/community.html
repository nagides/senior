<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Community</title>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css"
            rel="stylesheet">
        <link rel="stylesheet" href="../assets/css/navbar.css">
        <link rel="stylesheet" href="../assets/css/page-layout.css">
        <link rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
        <link
            href="https://fonts.googleapis.com/css2?family=Titillium+Web:ital@1&display=swap"
            rel="stylesheet">
        <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
        <script src="../assets/css/bootstrap.bundle.min.js"></script>
    </head>
    <style>
        img.profile {
    margin-top: 150%;
}
    </style>

    <body>
        <div class="flex-row">
            <div class="nav">
                <div class="sidebar">
                    <img
                        src="/assets/images/สัญลักษณ์ประจำมหาวิทยาลัยแม่ฟ้าหลวง.png"
                        width="50,70">
                    <p class="text-center" style="color: #A60303;">MFU</p>
                    <hr>
                    <li class="mt-5"> <a href="/db"><i class="bi bi-bar-chart"></i></a> </li>
                    <li class="mt-5"><a href="/listcourse"><i class="bi bi-map"></i></a></li>
                    <li class="mt-5"><a href="/search"><i class="bi bi-search"></i></a></li>
                    <li class="mt-5"><a href="/community"><i class="bi bi-chat"></i></a></li>
                    <li class="mt-5"><a href="/bookmark"><i class="bi bi-star"></i></a></li>
                    <li class="mt-5"><a href="/notification"><i class="bi bi-bell"></i></a></li>
                    <a href="/profile">
                        <img class="profile" src="/assets/images/Screenshot 2024-04-09 034908.png" width="51" height="48"
                            alt="">
                    </a>
                </div> 
            </div>
            <div class="container">
                <button class="btn btn" onclick="post()"> <i class="bi bi-plus-lg"></i>Post</button>
                

                <!-- <div id="postList" class="mt-5"></div> -->


                <div class="container">
                    <h1 class="mt-5" style="color: #A60303;">Community</h1>
                <!-- แสดงโพสต์ในกรอบที่คุณต้องการ -->
                    <div class="container-fluid">
                        <% posts.forEach(function(post, index) { %>
                            <div class="container-fluid card mt-5" onclick="topicone()">
                                <!-- <h4 class="mt-4"><a class="topic" href="#">Topic <%= index + 1 %></a></h4> -->
                                <p class="mt-4" style="color: #A60303; font-size: 25px;"><%= post %></p> <!-- แสดงเนื้อหาของโพสต์ -->
                                <div class="detail text-end">
                                    <span>12</span>
                                    <i class="bi bi-chat comment"></i>
                                </div>
                            </div>
                        <% }); %>
                
                    </div>
                </div>



                








                
                <div class="container-fluid card mt-5" onclick="topicone()">
                    <h4 class="mt-4"><a class="topic" href="#">Topic 1</a></h4>
                    <div class="detail text-end">
                        <span>12</span>
                        <i class="bi bi-chat comment"></i>
                    </div>
                </div>
                <div class="container-fluid card mt-5">
                    <h4 class="mt-4"><a class="topic" href="#">Topic 2</a></h4>
                    <div class="detail text-end">
                        <span>12</span>
                        <i class="bi bi-chat comment"></i>
                    </div>
                </div>
                <div class="container-fluid card mt-5">
                    <h4 class="mt-4"><a class="topic" href="#">Topic 3</a></h4>
                    <div class="detail text-end">
                        <span>12</span>
                        <i class="bi bi-chat comment"></i>
                    </div>
                </div>
                <div class="container-fluid card mt-5">
                    <h4 class="mt-4"><a class="topic" href="#">Topic 4</a></h4>
                    <div class="detail text-end">
                        <span>12</span>
                        <i class="bi bi-chat comment"></i>
                    </div>
                </div>
                <div class="container-fluid card mt-5">
                    <h4 class="mt-4"><a class="topic" href="#">Topic 5</a></h4>
                    <div class="detail text-end">
                        <span>12</span>
                        <i class="bi bi-chat comment"></i>
                    </div>
                </div>
                <div class="container-fluid card mt-5">
                    <h4 class="mt-4"><a class="topic" href="#">Topic 5</a></h4>
                    <div class="detail text-end">
                        <span>12</span>
                        <i class="bi bi-chat comment"></i>
                    </div>
                </div>
                <div class="container-fluid card mt-5">
                    <h4 class="mt-4"><a class="topic" href="#">Topic 5</a></h4>
                    <div class="detail text-end">
                        <span>12</span>
                        <i class="bi bi-chat comment"></i>
                    </div>
                </div>
                <div class="container-fluid card mt-5">
                    <h4 class="mt-4"><a class="topic" href="#">Topic 5</a></h4>
                    <div class="detail text-end">
                        <span>12</span>
                        <i class="bi bi-chat comment"></i>
                    </div>
                </div>
            </div>
        </div>
        
<!-- <script>
    function topicone (){
        window.location.href="/comment"
    }
    function post(){
        window.location.href="/post"
    }
</script> -->



<!-- <script>
    function displayPosts() {
        const posts = JSON.parse(localStorage.getItem('posts')) || [];
        const postList = document.getElementById('postList');
        postList.innerHTML = ''; // Clear existing posts

        posts.forEach((postContent, index) => {
            const postCard = document.createElement('div');
            postCard.className = 'container-fluid card mt-3';
            postCard.innerHTML = `
                <h4 class="mt-4">${postContent}</h4>
                <div class="detail text-end">
                    <span>${index + 1}</span>
                    <i class="bi bi-chat comment"></i>
                </div>
            `;
            postList.appendChild(postCard);
        });
    }
    function post(){
        window.location.href="/post"
    }

    // Call displayPosts when the page loads
    window.onload = displayPosts;
</script> -->

<script>
    // ดึงข้อมูลโพสต์จากเซิร์ฟเวอร์
    function fetchPosts() {
        fetch('/posts')
            .then(response => response.json())
            .then(posts => {
                const postsContainer = document.getElementById('postsContainer');
                postsContainer.innerHTML = ''; // ล้างเนื้อหาก่อน

                posts.forEach(post => {
                    const postElement = document.createElement('p');
                    postElement.textContent = post;
                    postsContainer.appendChild(postElement); // เพิ่มโพสต์ไปยัง container
                });
            })
            .catch(error => console.error('Error fetching posts:', error));
    }

    // เมื่อฟอร์มถูกส่ง
    document.getElementById('postForm').addEventListener('submit', function(event) {
        event.preventDefault(); // ป้องกันการรีเฟรชหน้า
        const formData = new FormData(this);
        const message = formData.get('message');

        fetch('/post', {
            method: 'POST',
            body: new URLSearchParams({ message })
        }).then(() => {
            this.reset(); // ล้างฟอร์ม
            fetchPosts(); // ดึงโพสต์ใหม่
        }).catch(error => console.error('Error posting message:', error));
    });

    // เรียกฟังก์ชันเพื่อดึงโพสต์เมื่อโหลดหน้า
    window.onload = fetchPosts;
</script>


    </body>
</html>